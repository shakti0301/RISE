CREATE DATABASE ShaktiRaolji

USE ShaktiRaolji

CREATE TABLE Customer (
    CustomerID INT PRIMARY KEY,
    CustomerName VARCHAR(150),
    City VARCHAR(50),
    JoinDate DATE
)

CREATE TABLE Product (
    ProductID INT PRIMARY KEY,
    ProductName VARCHAR(150),
    Category VARCHAR(50),
    Price Money
)

CREATE TABLE Orders (
    OrderID INT PRIMARY KEY,
    CustomerID INT FOREIGN KEY REFERENCES Customer(CustomerID),
    ProductID INT FOREIGN KEY REFERENCES Product(ProductID),
    OrderDate DATE,
    Quantity INT
)

INSERT INTO Customer VALUES 
    (1, 'Shakti', 'Anand', '2019-11-12'),
    (2, 'Shyam', 'Surat', '2022-01-04'),
    (3, 'Kushal', 'Vadodara', '2023-11-04'),
    (4, 'Divy', 'Bharuch', '2012-01-12'),
    (5, 'Miren', 'Navsari', '2021-04-04')


INSERT INTO Product VALUES
    (101, 'Mobile', 'Online', 12000),
    (102, 'Tablet', 'Offline', 15000),
    (103, 'Laptop', 'Offline', 60000),
    (104, 'Earburds', 'Online', 2300),
    (105, 'Watch', 'Online', 1200)

INSERT INTO Orders VALUES
    (1, 3, 102, '2023-05-05', 2),
    (2, 2, 105, '2023-05-05', 4),
    (3, 2, 102, '2023-05-05', 2),
    (4, 1, 104, '2023-05-05', 1),
    (5, 1, 101, '2023-05-05', 1)

SELECT * FROM Customer
SELECT * FROM Product
SELECT * FROM Orders

--1. Retrieve a list of all orders. Show the CustomerName, the ProductName, and the OrderDate
SELECT c.CustomerName, p.ProductName, OrderDate
FROM Customer c
JOIN Orders o
ON o.CustomerID = c.CustomerID
JOIN Product p
ON p.ProductID = o.ProductID

--2. Calculate the total revenue generated by each product category. Show the Category and the TotalRevenue
SELECT p.Category, SUM(p.Price) AS 'Total revenue generated'
FROM Product p
JOIN Orders o
ON o.ProductID = p.ProductID
GROUP BY Category

--3. List all customers who have never placed an order.
SELECT c.CustomerName AS 'Customers who have never placed an order'
FROM Customer c
LEFT JOIN Orders o
ON o.CustomerID = c.CustomerID
WHERE o.CustomerID IS NULL

--4. Select all customers and their order IDs. If they have no orders, the OrderID will naturally be NULL.
SELECT c.CustomerName, o.OrderID
FROM Customer c
Left JOIN Orders o 
ON o.CustomerID = c.CustomerID

--5. Find the names of customers who have bought more than 10 items in total.
SELECT c.CustomerName AS 'Customers who have bought more than 10 items in total', COUNT(o.OrderID)
FROM Customer c
JOIN Orders o
ON o.CustomerID = c.CustomerID
GROUP BY c.CustomerName
HAVING COUNT(o.OrderID) > 10

--6. Display a list of all Products and the OrderID associated with them. This list must include products that have never been sold.
SELECT p.ProductName, o.OrderID
FROM Product p
LEFT JOIN Orders o
ON p.ProductID = o.ProductID

--7. List all ProductNames that have been ordered by customers living in 'Vadodaraâ€™.
SELECT p.ProductName AS 'ProductNames that have been ordered by customers living in Vadodara'
FROM Product p
JOIN Orders o
ON o.ProductID = p.ProductID
JOIN Customer c
ON o.CustomerID = c.CustomerID
WHERE c.city = 'Vadodara'

--8. Display a list of all Product Names and their Prices, sorted from the cheapest to the most expensive.
SELECT p.ProductName, p.price
FROM Product p
ORDER BY Price ASC